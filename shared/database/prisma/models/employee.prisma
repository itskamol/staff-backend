model Employee {
  id                Int     @id @default(autoincrement())
  departmentId      Int     @map("department_id")
  organizationId    Int     @map("organization_id")
  policyId          Int     @map("policy_id")
  name              String
  address           String?
  phone             String?
  email             String?
  photo             String?
  additionalDetails String? @map("additional_details")

  // --- Standard Fields ---
  isActive       Boolean  @default(true) @map("is_active")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")
  employeePlanId Int?

  department    Department     @relation(fields: [departmentId], references: [id])
  policy        Policy         @relation(fields: [policyId], references: [id])
  credentials   Credential[]
  computerUsers ComputerUser[]
  actions       Action[]
  organization  Organization   @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  EmployeeSync  EmployeeSync[]

  EmployeePlan EmployeePlan? @relation(fields: [employeePlanId], references: [id])

  @@index([organizationId])
  @@index([organizationId, departmentId])
  @@index([organizationId, policyId])
  @@index([organizationId, isActive])
  @@index([email])
  @@map("employees")
}

model Credential {
  id                Int        @id @default(autoincrement())
  employeeId        Int        @map("employee_id")
  code              String
  type              ActionType
  additionalDetails String?    @map("additional_details")
  organizationId    Int?       @map("organization_id")

  // --- Standard Fields ---
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  organization Organization? @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  employee     Employee      @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@unique([employeeId, code, type], name: "emp_credential_unique")
  @@index([employeeId])
  @@index([code])
  @@index([type])
  @@map("credentials")
}

model EmployeeSync {
  id             Int        @id @default(autoincrement())
  employeeId     Int
  deviceId       Int
  gateId         Int
  status         StatusEnum @default(INP)
  message        String?
  organizationId Int?       @map("organization_id")

  organization Organization? @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  gate         Gate          @relation(fields: [gateId], references: [id])
  device       Device        @relation(fields: [deviceId], references: [id])
  employee     Employee      @relation(fields: [employeeId], references: [id])
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model EmployeePlan {
  id             Int     @id @default(autoincrement())
  name String?
  addadditionalDetails String?
  startTime      String
  endTime        String
  extraTime      String
  weekdays       String
  isActive       Boolean @default(true)
  organizationId Int?    @map("organization_id")

  organization Organization? @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  Employee     Employee[]
}
