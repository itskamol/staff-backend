model ActiveWindow {
  id             Int       @id @default(autoincrement())
  computerUserId Int       @map("computer_user_id")
  organizationId Int       @map("organization_id")
  datetime       DateTime
  title          String
  processName    String    @map("process_name")
  icon           String?
  activeTime     Int       @map("active_time") // in seconds
  createdAt      DateTime  @default(now()) @map("created_at")
  deletedAt      DateTime? @map("deleted_at")

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  computerUser ComputerUser @relation(fields: [computerUserId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([computerUserId])
  @@index([computerUserId, datetime])
  @@index([datetime])
  @@index([processName])
  @@map("active_windows")
}

model VisitedSite {
  id             Int       @id @default(autoincrement())
  computerUserId Int       @map("computer_user_id")
  organizationId Int       @map("organization_id")
  datetime       DateTime
  title          String?
  url            String
  processName    String    @map("process_name")
  icon           String?
  activeTime     Int       @map("active_time") // in seconds
  createdAt      DateTime  @default(now()) @map("created_at")
  deletedAt      DateTime? @map("deleted_at")

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  computerUser ComputerUser @relation(fields: [computerUserId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([computerUserId])
  @@index([computerUserId, datetime])
  @@index([datetime])
  @@index([url])
  @@index([processName])
  @@map("visited_sites")
}

model Screenshot {
  id             Int       @id @default(autoincrement())
  computerUserId Int       @map("computer_user_id")
  organizationId Int       @map("organization_id")
  datetime       DateTime
  title          String?
  filePath       String    @map("file_path")
  processName    String    @map("process_name")
  icon           String?
  createdAt      DateTime  @default(now()) @map("created_at")
  deletedAt      DateTime? @map("deleted_at")

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  computerUser ComputerUser @relation(fields: [computerUserId], references: [id], onDelete: Cascade)

  @@index([computerUserId])
  @@index([computerUserId, datetime])
  @@index([datetime])
  @@index([filePath])
  @@map("screenshots")
}

model UserSession {
  id             Int         @id @default(autoincrement())
  organizationId Int         @map("organization_id")
  computerUserId Int         @map("computer_user_id")
  startTime      DateTime    @map("start_time")
  endTime        DateTime?   @map("end_time")
  sessionType    SessionType @map("session_type")

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  computerUser ComputerUser @relation(fields: [computerUserId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@index([computerUserId])
  @@index([computerUserId, startTime])
  @@index([startTime])
  @@index([sessionType])
  @@map("user_sessions")
}
