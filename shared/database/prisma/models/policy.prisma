model Policy {
  id                    Int      @id @default(autoincrement())
  organizationId        Int      @map("organization_id")
  title                 String
  description           String?
  isActiveWindowEnabled Boolean  @default(false) @map("active_window")
  isScreenshotEnabled   Boolean  @default(false) @map("screenshot")
  isVisitedSitesEnabled Boolean  @default(false) @map("visited_sites")
  isDefault             Boolean  @default(false) @map("is_default")
  screenshotInterval    Int      @default(5) @map("screenshot_interval")
  screenshotIsGrayscale Boolean  @default(false) @map("screenshot_is_grayscale")
  screenshotCaptureAll  Boolean  @default(false) @map("screenshot_capture_all")
  isActive              Boolean  @default(true) @map("is_active")
  createdAt             DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt             DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  employees    Employee[]
  rules        PolicyRule[]

  @@unique([organizationId, title])
  @@map("policies")
}

model PolicyRule {
  id       Int      @id @default(autoincrement())
  policyId Int      @map("policy_id")
  type     RuleType // USEFUL, UNUSEFUL

  policy Policy          @relation(fields: [policyId], references: [id], onDelete: Cascade)
  groups ResourceGroup[]

  @@index([policyId])
  @@map("policy_rules")
}

model ResourceGroup {
  id             Int          @id @default(autoincrement())
  organizationId Int          @map("organization_id")
  name           String
  type           ResourceType // WEBSITE, APPLICATION
  isActive       Boolean      @default(true) @map("is_active")
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime     @updatedAt @map("updated_at") @db.Timestamptz(6)

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  resources    Resource[]
  rules        PolicyRule[]

  @@unique([organizationId, name, type])
  @@map("resource_groups")
}

model Resource {
  id             Int          @id @default(autoincrement())
  organizationId Int          @map("organization_id")
  value          String
  type           ResourceType
  createdAt      DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)

  organization Organization    @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  groups       ResourceGroup[]

  @@unique([organizationId, value, type])
  @@map("resources")
}
