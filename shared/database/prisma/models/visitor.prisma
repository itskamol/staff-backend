model Visitor {
  id                Int      @id @default(autoincrement())
  firstName         String   @map("first_name")
  lastName          String   @map("last_name")
  middleName        String?  @map("middle_name")
  birthday          String?
  phone             String?
  passportNumber    String?  @map("passport_number")
  pinfl             String?
  workPlace         String?  @map("work_place")
  additionalDetails String?  @map("additional_details")
  creatorId         Int      @map("creator_id")
  isActive          Boolean  @default(true) @map("is_active")
  createdAt         DateTime @default(now()) @map("created_at")

  creator      User          @relation("CreatedVisitors", fields: [creatorId], references: [id], onDelete: Restrict)
  onetimeCodes OnetimeCode[]
  actions      Action[]

  @@index([creatorId])
  @@index([phone])
  @@index([passportNumber])
  @@index([pinfl])
  @@index([isActive])
  @@index([createdAt])
  @@map("visitors")
}

model OnetimeCode {
  id                Int             @id @default(autoincrement())
  visitorId         Int             @map("visitor_id")
  codeType          VisitorCodeType @map("code_type")
  code              String
  additionalDetails String?         @map("additional_details")
  startDate         DateTime        @map("start_date")
  endDate           DateTime        @map("end_date")

  // --- Standard Fields ---
  isActive  Boolean  @default(true) @map("is_active")
  createdAt DateTime @default(now()) @map("created_at")

  visitor Visitor @relation(fields: [visitorId], references: [id], onDelete: Cascade)

  @@index([visitorId])
  @@index([code])
  @@index([startDate, endDate])
  @@index([isActive])
  @@map("onetime_codes")
}
