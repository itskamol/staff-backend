model Visitor {
  id                Int       @id @default(autoincrement())
  firstName         String    @map("first_name")
  lastName          String    @map("last_name")
  middleName        String?   @map("middle_name")
  birthday          String?
  phone             String?
  passportNumber    String?   @map("passport_number")
  pinfl             String?
  workPlace         String?   @map("work_place")
  additionalDetails String?   @map("additional_details")
  creatorId         Int       @map("creator_id")
  isActive          Boolean   @default(true) @map("is_active")
  createdAt         DateTime  @default(now()) @map("created_at")
  deletedAt         DateTime? @map("deleted_at")
  organizationId    Int       @map("organization_id")

  organization Organization  @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  creator      User          @relation("CreatedVisitors", fields: [creatorId], references: [id], onDelete: Restrict)
  onetimeCodes OnetimeCode[]
  actions      Action[]

  @@index([organizationId])
  @@map("visitors")
}

model OnetimeCode {
  id                Int             @id @default(autoincrement())
  visitorId         Int             @map("visitor_id")
  codeType          VisitorCodeType @map("code_type")
  code              String
  additionalDetails String?         @map("additional_details")
  startDate         DateTime        @map("start_date")
  endDate           DateTime        @map("end_date")
  isActive          Boolean         @default(true) @map("is_active")
  createdAt         DateTime        @default(now()) @map("created_at")
  deletedAt         DateTime?       @map("deleted_at")
  organizationId    Int             @map("organization_id")

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  visitor      Visitor      @relation(fields: [visitorId], references: [id], onDelete: Cascade)

  @@index([organizationId])
  @@map("onetime_codes")
}
